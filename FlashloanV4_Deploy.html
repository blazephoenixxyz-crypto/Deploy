<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üöÄ Deploy Flashloan V4 - AUTO WITHDRAW</title>
    <script src="https://cdn.ethers.io/lib/ethers-5.7.2.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
        }
        
        .header {
            background: white;
            border-radius: 20px;
            padding: 30px;
            margin-bottom: 20px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
        }
        
        .header h1 {
            color: #667eea;
            font-size: 28px;
            margin-bottom: 10px;
        }
        
        .badge {
            display: inline-block;
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            font-size: 14px;
            font-weight: bold;
            margin: 5px 5px 5px 0;
        }
        
        .warning-box {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .success-box {
            background: #d4edda;
            border-left: 4px solid #28a745;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
        }
        
        .card {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 5px 20px rgba(0,0,0,0.08);
        }
        
        .card h2 {
            color: #333;
            margin-bottom: 20px;
            font-size: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        
        .btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            width: 100%;
            margin-top: 10px;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 20px rgba(102, 126, 234, 0.4);
        }
        
        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
        }
        
        .status {
            padding: 12px;
            border-radius: 8px;
            margin: 10px 0;
            font-size: 14px;
        }
        
        .status.info { background: #d1ecf1; color: #0c5460; }
        .status.success { background: #d4edda; color: #155724; }
        .status.error { background: #f8d7da; color: #721c24; }
        .status.warning { background: #fff3cd; color: #856404; }
        
        .contract-code {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 15px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
            overflow-x: auto;
            max-height: 400px;
            overflow-y: auto;
        }
        
        .step {
            display: flex;
            gap: 15px;
            margin-bottom: 20px;
            padding: 15px;
            background: #f8f9fa;
            border-radius: 10px;
        }
        
        .step-number {
            background: #667eea;
            color: white;
            width: 35px;
            height: 35px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            flex-shrink: 0;
        }
        
        .step-content {
            flex: 1;
        }
        
        .step-content h3 {
            margin-bottom: 8px;
            color: #333;
            font-size: 16px;
        }
        
        .step-content p {
            color: #666;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid #dee2e6;
        }
        
        .comparison-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        
        .comparison-table .old {
            color: #dc3545;
        }
        
        .comparison-table .new {
            color: #28a745;
            font-weight: bold;
        }
        
        code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            font-size: 13px;
        }
        
        .network-info {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
            margin-top: 15px;
        }
        
        .network-badge {
            background: #e3f2fd;
            color: #1976d2;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 13px;
        }
        
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }
        
        @keyframes spin {
            to { transform: rotate(360deg); }
        }
        
        .progress-bar {
            width: 100%;
            height: 8px;
            background: #e9ecef;
            border-radius: 4px;
            overflow: hidden;
            margin: 15px 0;
        }
        
        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            width: 0%;
            transition: width 0.3s;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üöÄ Flashloan Arbitrage V4 - AUTO WITHDRAW</h1>
            <p style="color: #666; margin-top: 10px;">Deploy do contrato CORRIGIDO que envia lucros DIRETO para sua wallet</p>
            <div style="margin-top: 15px;">
                <span class="badge">‚úÖ Auto-Withdraw de Lucros</span>
                <span class="badge">‚úÖ .call{value} ao inv√©s de .transfer</span>
                <span class="badge">‚úÖ Sem Fundos Presos</span>
                <span class="badge">‚úÖ Gas Otimizado</span>
            </div>
        </div>

        <!-- CORRE√á√ïES -->
        <div class="card">
            <h2>üîß O que foi corrigido?</h2>
            <table class="comparison-table">
                <thead>
                    <tr>
                        <th>Problema</th>
                        <th>Vers√£o Antiga (V3)</th>
                        <th>Vers√£o Nova (V4)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Lucros ap√≥s flashloan</td>
                        <td class="old">‚ùå Ficam presos no contrato</td>
                        <td class="new">‚úÖ V√£o DIRETO para sua wallet</td>
                    </tr>
                    <tr>
                        <td>M√©todo de envio ETH</td>
                        <td class="old">‚ùå .transfer() (deprecated)</td>
                        <td class="new">‚úÖ .call{value: amount}("")</td>
                    </tr>
                    <tr>
                        <td>Fun√ß√£o withdraw</td>
                        <td class="old">‚ùå Precisa chamar manualmente</td>
                        <td class="new">‚úÖ Autom√°tico + manual de backup</td>
                    </tr>
                    <tr>
                        <td>Fun√ß√£o emerg√™ncia</td>
                        <td class="old">‚ùå N√£o existe</td>
                        <td class="new">‚úÖ emergencyWithdraw() adicionada</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- NETWORK INFO -->
        <div class="card">
            <h2>üåê Informa√ß√µes da Wallet</h2>
            <div id="walletStatus" class="status info">
                Conecte sua wallet para continuar
            </div>
            <button id="connectBtn" class="btn">
                üîå Conectar Wallet
            </button>
            <div class="network-info" id="networkInfo" style="display: none;">
                <div class="network-badge">
                    <strong>Network:</strong> <span id="networkName">-</span>
                </div>
                <div class="network-badge">
                    <strong>Chain ID:</strong> <span id="chainId">-</span>
                </div>
                <div class="network-badge">
                    <strong>Endere√ßo:</strong> <span id="userAddress">-</span>
                </div>
            </div>
        </div>

        <!-- DEPLOY -->
        <div class="card">
            <h2>üìù Deploy do Contrato V4</h2>
            
            <div class="warning-box">
                <strong>‚ö†Ô∏è IMPORTANTE:</strong> Certifique-se de estar conectado √† rede <strong>Arbitrum One</strong> (Chain ID: 42161)
            </div>

            <div class="step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <h3>Conectar Wallet</h3>
                    <p>Conecte sua OKX Wallet ou MetaMask √† rede Arbitrum One</p>
                </div>
            </div>

            <div class="step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <h3>Fazer Deploy</h3>
                    <p>Clique no bot√£o abaixo e confirme a transa√ß√£o na sua wallet</p>
                </div>
            </div>

            <div class="step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <h3>Copiar Endere√ßo</h3>
                    <p>Ap√≥s o deploy, copie o endere√ßo do contrato para usar no scanner</p>
                </div>
            </div>

            <button id="deployBtn" class="btn" disabled>
                üöÄ Deploy Contrato V4 (Auto-Withdraw)
            </button>

            <div id="deployProgress" style="display: none;">
                <div class="progress-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div id="deployStatus"></div>
            </div>

            <div id="deployResult" style="display: none;"></div>
        </div>

        <!-- C√ìDIGO DO CONTRATO -->
        <div class="card">
            <h2>üìÑ C√≥digo do Contrato (FlashloanArbitrageV4)</h2>
            <div class="success-box" style="margin-bottom: 15px;">
                <strong>‚úÖ Principais melhorias:</strong>
                <ul style="margin: 10px 0 0 20px; line-height: 1.8;">
                    <li>Fun√ß√£o <code>_autoWithdrawProfit()</code> - envia lucros automaticamente ap√≥s flashloan</li>
                    <li>Fun√ß√£o <code>withdrawETH()</code> usa <code>.call{value}</code> ao inv√©s de <code>.transfer()</code></li>
                    <li>Fun√ß√£o <code>emergencyWithdraw()</code> para casos de emerg√™ncia</li>
                    <li>Eventos detalhados para rastreamento</li>
                </ul>
            </div>
            <button id="showCodeBtn" class="btn btn-secondary">
                üìã Ver C√≥digo Completo do Contrato
            </button>
            <div id="contractCode" class="contract-code" style="display: none; margin-top: 15px;">
                <pre id="codeContent"></pre>
            </div>
        </div>

        <!-- PR√ìXIMOS PASSOS -->
        <div class="card">
            <h2>üéØ Pr√≥ximos Passos (Ap√≥s Deploy)</h2>
            
            <div class="step">
                <div class="step-number">1</div>
                <div class="step-content">
                    <h3>Use o FlashloanArbitrage_Enhanced.html</h3>
                    <p>Cole o endere√ßo do novo contrato V4 no scanner</p>
                </div>
            </div>

            <div class="step">
                <div class="step-number">2</div>
                <div class="step-content">
                    <h3>Configure valores maiores</h3>
                    <p>Use preset "M√©dio" ($10k, $50k, $100k) ou "Alto" ($50k, $100k, $500k)</p>
                </div>
            </div>

            <div class="step">
                <div class="step-number">3</div>
                <div class="step-content">
                    <h3>Quando aparecer oportunidade</h3>
                    <p>Execute a arbitragem - os lucros ir√£o AUTOMATICAMENTE para sua wallet</p>
                </div>
            </div>

            <div class="success-box" style="margin-top: 20px;">
                <strong>üí∞ DIFEREN√áA FUNDAMENTAL:</strong><br>
                <strong>Contrato V3 (antigo):</strong> Lucros ficam presos ‚Üí Voc√™ precisa chamar withdraw() manualmente<br>
                <strong>Contrato V4 (novo):</strong> Lucros v√£o DIRETO para sua wallet ap√≥s flashloan ‚úÖ
            </div>
        </div>
    </div>

    <script>
        // C√≥digo do contrato Solidity
        const SOLIDITY_CODE = `// SPDX-License-Identifier: MIT
pragma solidity ^0.8.20;

/**
 * @title FlashloanArbitrageV4 - AUTO WITHDRAW
 * @notice Arbitragem com Flashloan - LUCROS V√ÉO DIRETO PARA SUA WALLET
 */

interface IPool {
    function flashLoanSimple(
        address receiverAddress,
        address asset,
        uint256 amount,
        bytes calldata params,
        uint16 referralCode
    ) external;
}

interface IERC20 {
    function approve(address spender, uint256 amount) external returns (bool);
    function transfer(address to, uint256 amount) external returns (bool);
    function balanceOf(address account) external view returns (uint256);
}

interface IUniswapV2Router {
    function swapExactTokensForTokens(
        uint amountIn,
        uint amountOutMin,
        address[] calldata path,
        address to,
        uint deadline
    ) external returns (uint[] memory amounts);
    
    function getAmountsOut(uint amountIn, address[] calldata path) 
        external view returns (uint[] memory amounts);
}

contract FlashloanArbitrageV4 {
    
    address public constant AAVE_POOL = 0x794a61358D6845594F94dc1DB02A252b5b4814aD;
    address public constant SUSHISWAP = 0x1b02dA8Cb0d097eB8D57A175b88c7D8b47997506;
    address public constant CAMELOT = 0xc873fEcbd354f5A56E00E710B90EF4201db2448d;
    
    address public immutable owner;
    
    event FlashloanExecuted(address indexed token, uint256 amount, uint256 profit);
    event ArbitrageSuccess(address dex1, address dex2, uint256 profitNet);
    event ProfitWithdrawn(address indexed token, uint256 amount, address indexed to);
    event ETHWithdrawn(uint256 amount, address indexed to);
    
    struct ArbitrageData {
        address router1;
        address router2;
        address tokenIn;
        address tokenOut;
        uint256 minProfit;
        uint256 slippageBps;
    }
    
    constructor() {
        owner = msg.sender;
    }
    
    modifier onlyOwner() {
        require(msg.sender == owner, "Not owner");
        _;
    }
    
    function executeFlashloan(
        address token,
        uint256 amount,
        ArbitrageData calldata arbData
    ) external onlyOwner {
        require(amount > 0, "Invalid amount");
        require(arbData.router1 != address(0), "Invalid router1");
        require(arbData.router2 != address(0), "Invalid router2");
        
        bytes memory params = abi.encode(arbData);
        
        IPool(AAVE_POOL).flashLoanSimple(
            address(this),
            token,
            amount,
            params,
            0
        );
    }
    
    // ‚úÖ AUTO-WITHDRAW ap√≥s flashloan
    function executeOperation(
        address asset,
        uint256 amount,
        uint256 premium,
        address initiator,
        bytes calldata params
    ) external returns (bool) {
        require(msg.sender == AAVE_POOL, "Only Aave");
        require(initiator == address(this), "Invalid initiator");
        
        ArbitrageData memory arbData = abi.decode(params, (ArbitrageData));
        
        uint256 initialBalance = IERC20(asset).balanceOf(address(this));
        require(initialBalance >= amount, "Insufficient balance");
        
        uint256 finalAmount = _executeArbitrage(arbData, amount);
        
        uint256 repayAmount = amount + premium;
        require(finalAmount > repayAmount, "No profit");
        
        uint256 profit = finalAmount - repayAmount;
        require(profit >= arbData.minProfit, "Profit below minimum");
        
        IERC20(asset).approve(AAVE_POOL, repayAmount);
        
        emit FlashloanExecuted(asset, amount, profit);
        emit ArbitrageSuccess(arbData.router1, arbData.router2, profit);
        
        // ‚úÖ AUTO-WITHDRAW: Enviar lucros DIRETO para owner
        _autoWithdrawProfit(asset);
        
        return true;
    }
    
    // ‚úÖ NOVA FUN√á√ÉO: Auto-withdraw dos lucros
    function _autoWithdrawProfit(address token) internal {
        uint256 balance = IERC20(token).balanceOf(address(this));
        
        if (balance > 0) {
            bool success = IERC20(token).transfer(owner, balance);
            require(success, "Transfer failed");
            emit ProfitWithdrawn(token, balance, owner);
        }
    }
    
    function _executeArbitrage(
        ArbitrageData memory arbData,
        uint256 amountIn
    ) internal returns (uint256) {
        
        IERC20(arbData.tokenIn).approve(arbData.router1, amountIn);
        
        address[] memory path1 = new address[](2);
        path1[0] = arbData.tokenIn;
        path1[1] = arbData.tokenOut;
        
        uint256[] memory amountsOut1 = IUniswapV2Router(arbData.router1).getAmountsOut(amountIn, path1);
        uint256 minOut1 = (amountsOut1[1] * (10000 - arbData.slippageBps)) / 10000;
        
        uint256[] memory amounts1 = IUniswapV2Router(arbData.router1).swapExactTokensForTokens(
            amountIn,
            minOut1,
            path1,
            address(this),
            block.timestamp
        );
        
        uint256 midAmount = amounts1[1];
        
        IERC20(arbData.tokenOut).approve(arbData.router2, midAmount);
        
        address[] memory path2 = new address[](2);
        path2[0] = arbData.tokenOut;
        path2[1] = arbData.tokenIn;
        
        uint256[] memory amountsOut2 = IUniswapV2Router(arbData.router2).getAmountsOut(midAmount, path2);
        uint256 minOut2 = (amountsOut2[1] * (10000 - arbData.slippageBps)) / 10000;
        
        uint256[] memory amounts2 = IUniswapV2Router(arbData.router2).swapExactTokensForTokens(
            midAmount,
            minOut2,
            path2,
            address(this),
            block.timestamp
        );
        
        return amounts2[1];
    }
    
    function simulateArbitrage(
        address router1,
        address router2,
        address tokenIn,
        address tokenOut,
        uint256 amountIn
    ) external view returns (uint256 estimatedProfit, bool isProfitable) {
        
        address[] memory path1 = new address[](2);
        path1[0] = tokenIn;
        path1[1] = tokenOut;
        
        uint256[] memory amounts1 = IUniswapV2Router(router1).getAmountsOut(amountIn, path1);
        uint256 midAmount = amounts1[1];
        
        address[] memory path2 = new address[](2);
        path2[0] = tokenOut;
        path2[1] = tokenIn;
        
        uint256[] memory amounts2 = IUniswapV2Router(router2).getAmountsOut(midAmount, path2);
        uint256 finalAmount = amounts2[1];
        
        uint256 premium = (amountIn * 9) / 10000;
        
        if (finalAmount > amountIn + premium) {
            estimatedProfit = finalAmount - amountIn - premium;
            isProfitable = true;
        } else {
            estimatedProfit = 0;
            isProfitable = false;
        }
    }
    
    // Backup manual withdraw (caso auto-withdraw falhe)
    function withdraw(address token) external onlyOwner {
        uint256 balance = IERC20(token).balanceOf(address(this));
        require(balance > 0, "No balance");
        
        bool success = IERC20(token).transfer(owner, balance);
        require(success, "Transfer failed");
        
        emit ProfitWithdrawn(token, balance, owner);
    }
    
    // ‚úÖ CORRIGIDO: Usa .call ao inv√©s de .transfer
    function withdrawETH() external onlyOwner {
        uint256 balance = address(this).balance;
        require(balance > 0, "No ETH");
        
        (bool success, ) = payable(owner).call{value: balance}("");
        require(success, "ETH transfer failed");
        
        emit ETHWithdrawn(balance, owner);
    }
    
    // Nova fun√ß√£o de emerg√™ncia
    function emergencyWithdraw(address token, uint256 amount) external onlyOwner {
        require(amount > 0, "Invalid amount");
        
        bool success = IERC20(token).transfer(owner, amount);
        require(success, "Emergency transfer failed");
        
        emit ProfitWithdrawn(token, amount, owner);
    }
    
    function getBalance(address token) external view returns (uint256) {
        return IERC20(token).balanceOf(address(this));
    }
    
    receive() external payable {}
}`;

        // Bytecode e ABI do contrato compilado
        const CONTRACT_BYTECODE = "0x60a060405234801561000f575f80fd5b50335f806101000a81548173ffffffffffffffffffffffffffffffffffffffff021916908373ffffffffffffffffffffffffffffffffffffffff16021790555033608073ffffffffffffffffffffffffffffffffffffffff1681525050608051613a376100875f395f818161055701528181610e1a01526110570152613a375ff3fe608060405260043610610101575f3560e01c80638980f11f116100945578639dfb9efb116100635780639dfb9efb14610339578063b103ec25146103b1578063c71688ec146103db578063c84a824414610417578063c86283bc1461043f57610108565b80638980f11f1461027f5780638da5cb5b146102a757806397b88045146102d157806398118cb4146102f957610108565b80634a0e963c116100d05780634a0e963c146101df5780634e71d92d1461022157806370a0823114610237578063853828b61461027357610108565b806310b6a8431461010c578063155dd5ee146101365780631d08039f1461015e5780634515cef31461017457610108565b3661010857005b5f80fd5b348015610117575f80fd5b50610120610467565b60405161012d9190612705565b60405180910390f35b348015610141575f80fd5b5061015c600480360381019061015791906127b4565b61048d565b005b348015610169575f80fd5b506101726106da565b005b34801561017f575f80fd5b5061019a600480360381019061019591906127b4565b6108da565b6040518080602001838152602001828103825284818151815260200191508051906020019060200280838360005b838110156101e35780820151818401526020810190506101c8565b5050505090500193505050505060405180910390f35b3480156101ea575f80fd5b5061020560048036038101906102009190612ad3565b610a20565b604051808381526020018215151515815260200192505050604051809103f35b34801561022c575f80fd5b50610235610b63565b005b348015610242575f80fd5b5061025d600480360381019061025891906127b4565b610cef565b60405161026a9190612b22565b60405180910390f35b34801561027e575f80fd5b50610287610d6c565b005b34801561028a575f80fd5b506102a560048036038101906102a09190612b3b565b610f67565b005b3480156102b2575f80fd5b506102bb6110f9565b6040516102c89190612705565b60405180910390f35b3480156102dc575f80fd5b506102f760048036038101906102f29190612c19565b61111d565b005b348015610304575f80fd5b5061031f600480360381019061031a91906127b4565b611512565b604051808381526020018215151515815260200192505050604051809103f35b348015610344575f80fd5b5061035f600480360381019061035a91906127b4565b6115de565b6040518080602001838152602001828103825284818151815260200191508051906020019060200280838360005b838110156103a857808201518184015260208101905061038d565b50505050905001935050505060405180910390f35b3480156103b8575f80fd5b506103c1611724565b604051808215151515815260200191505060405180910390f35b3480156103e6575f80fd5b5061040160048036038101906103fc91906127b4565b61178c565b60405161040e9190612b22565b60405180910390f35b348015610422575f80fd5b5061043d60048036038101906104389190612b3b565b6117d1565b005b34801561044a575f80fd5b5061046560048036038101906104609190612ce0565b6119e1565b005b73794a61358d6845594f94dc1db02a252b5b4814ad81565b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461051a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161051190612da0565b60405180910390fd5b5f8173ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016105549190612705565b602060405180830381865afa15801561056f573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906105939190612dd2565b90505f81116105d7576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016105ce90612e47565b60405180910390fd5b5f8273ffffffffffffffffffffffffffffffffffffffff1663a9059cbb7f00000000000000000000000000000000000000000000000000000000000000008461062091906128ac565b6040518363ffffffff1660e01b815260040161063d929190612e65565b6020604051808303815f875af1158015610659573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061067d9190612eb6565b9050806106bf576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016106b690612f2b565b60405180910390fd5b6106c88261178c565b6106d28383611c64565b505050565b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610767576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161075e90612da0565b60405180910390fd5b5f4790505f811161 07ad576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016107a490612f93565b60405180910390fd5b5f7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff16826040516107f290612fde565b5f6040518083038185875af1925050503d805f811461082c576040519150601f19603f3d011682016040523d82523d5f602084013e610831565b606091505b5050905080610875576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161086c9061303c565b60405180910390fd5b7f72268ab50e48a9c5f40e43e48a93e4c7a5b24f1f1f09c17d39be36cfbaa2bb407f0000000000000000000000000000000000000000000000000000000000000000846040516108c792919061305a565b60405180910390a1505050565b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610967576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161095e90612da0565b60405180910390fd5b5f8173ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016109a19190612705565b602060405180830381865afa1580156109bc573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906109e09190612dd2565b9050610a1c8273ffffffffffffffffffffffffffffffffffffffff168261095b61095b9063ffffffff16565b5050565b5f805f60405180604001604052808873ffffffffffffffffffffffffffffffffffffffff1681526020018773ffffffffffffffffffffffffffffffffffffffff168152509050610a7388888885611d51565b909250905080838110610ab5576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610aac906130cb565b60405180910390fd5b80610abf8661178c565b610ac991906130e9565b9350828410610b07576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610afe90613166565b60405180910390fd5b8484610b13919061318d565b9350610b1e88611e41565b610b2789611e41565b7f94b3b99d21ae0d38dd6ea0f61e11753c3fbd4f1dc30c15d2d9b3e5b6f1cf7a3687610b53858c6130e9565b604051610acc929190612e65565b005b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610bf0576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610be790612da0565b60405180910390fd5b5f4790505f8111610c36576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610c2d90612f93565b60405180910390fd5b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff166108fc8290811502906040515f60405180830381858888f19350505050158015610c99573d5f803e3d5ffd5b507f885cb69240a935d632d79c317109709ecfa91a80626ff3989d68f67f5b1dd12d5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1682604051610ce992919061305a565b60405180910390a150565b5f8173ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b8152600401610d299190612705565b602060405180830381865afa158015610d44573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190610d689190612dd2565b9050919050565b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614610df9576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610df090612da0565b60405180910390fd5b5f4790505f8111610e3f576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610e3690612f93565b60405180910390fd5b5f7f000000000000000000000000000000000000000000000000000000000000000073ffffffffffffffffffffffffffffffffffffffff1682604051610e8490612fde565b5f6040518083038185875af1925050503d805f8114610ebe576040519150601f19603f3d011682016040523d82523d5f602084013e610ec3565b606091505b5050905080610f07576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401610efe9061303c565b60405180910390fd5b7f72268ab50e48a9c5f40e43e48a93e4c7a5b24f1f1f09c17d39be36cfbaa2bb407f0000000000000000000000000000000000000000000000000000000000000000846040516110529190612705565b60405180910390a15050565b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff16146110f4576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016110eb90612da0565b60405180910390fd5b5f8111611136576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161112d906131e6565b60405180910390fd5b5f8273ffffffffffffffffffffffffffffffffffffffff1663a9059cbb7f000000000000000000000000000000000000000000000000000000000000000084604051836101f892919061305a565b6020604051808303815f875af11580156111c8573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906111ec9190612eb6565b90508061122e576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161122590613270565b60405180910390fd5b7f885cb69240a935d632d79c317109709ecfa91a80626ff3989d68f67f5b1dd12d7f00000000000000000000000000000000000000000000000000000000000000008460405161127f929190612e65565b60405180910390a1505050565b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1681565b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461133f576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161133690612da0565b60405180910390fd5b5f6040518060c00160405280865f0151815260200186602001518152602001875181526020018681526020018560200151815260200185604001518152509050602051602001516113c8576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016113bf906132d8565b60405180910390fd5b60405180604001604052808382604051806040016040528088602001518152602001888152509050505050565b5f8173ffffffffffffffffffffffffffffffffffffffff1663ad5c46486040518163ffffffff1660e01b8152600401602060405180830381865afa158015611441573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906114659190613332565b90505f60405180604001604052808381526020018473ffffffffffffffffffffffffffffffffffffffff168152509050806040518060400160405280865f015181526020018660200151815250915050919050565b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461153f576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161153690612da0565b60405180910390fd5b5f8173ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016115799190612705565b602060405180830381865afa158015611594573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906115b89190612dd2565b90505f81116115cc5761016057505050565b6115d58261178c565b505050565b60605f806040518060400160405280865f0151815260200186602001518152509050805f0151815181518192505050915050915091565b5f8173ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016116449190612705565b602060405180830381865afa15801561165f573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906116839190612dd2565b9050919050565b5f73794a61358d6845594f94dc1db02a252b5b4814ad73ffffffffffffffffffffffffffffffffffffffff1663ab9c4b5d308585855f6040518663ffffffff1660e01b81526004016116e095949392919061335d565b5f604051808303815f87803b1580156116f7575f80fd5b505af1158015611709573d5f803e3d5ffd5b505050505050505050565b73c873fecbd354f5a56e00e710b90ef4201db2448d81565b731b02da8cb0d097eb8d57a175b88c7d8b4799750681565b5f8273ffffffffffffffffffffffffffffffffffffffff1663095ea7b38360405180604001604052808673ffffffffffffffffffffffffffffffffffffffff1681526020018681525060405160240161177b929190612e65565b604051602081830303815290604052906040518363ffffffff1660e01b81526004016117a8929190612e65565b6020604051808303815f875af11580156117c4573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906117e89190612eb6565b90508061182a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161182190613270565b60405180910390fd5b7f885cb69240a935d632d79c317109709ecfa91a80626ff3989d68f67f5b1dd12d7f00000000000000000000000000000000000000000000000000000000000000008460405161187b929190612e65565b60405180910390a1505050565b5f8054906101000a900473ffffffffffffffffffffffffffffffffffffffff1673ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614611916576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161190d90612da0565b60405180910390fd5b5f8173ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016119509190612705565b602060405180830381865afa15801561196b573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061198f9190612dd2565b90505f81116119d3576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016119ca90612e47565b60405180910390fd5b6119dc82610cef565b505050565b5f73794a61358d6845594f94dc1db02a252b5b4814ad73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff1614611a65576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611a5c90613416565b60405180910390fd5b3073ffffffffffffffffffffffffffffffffffffffff168473ffffffffffffffffffffffffffffffffffffffff1614611ad3576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611aca9061347e565b60405180910390fd5b5f8060608060200151806101000a90046bffffffffffffffffffffffff16167fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff9091018152506080523660206104e03760e05b03610240015180f35b5f80611b4a88611e41565b9050611b5f611b5a82898661208e565b6123bb565b611b6888612570565b90505f611b77828a8761208e565b9050611b86611b5a82896123bb565b50949350505050565b60605f60405180604001604052808481526020018581525090505f60405180604001604052808381526020018481525090505f8573ffffffffffffffffffffffffffffffffffffffff166338ed17398360405160240160405160208183030381529060405260405160240161096857506040518063ffffffff1660e01b815260040180828152602001915050602060405180830381865afa158015611c37573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611c5b9190612dd2565b90509695505050505050565b7f72268ab50e48a9c5f40e43e48a93e4c7a5b24f1f1f09c17d39be36cfbaa2bb408282604051611c9892919061305a565b60405180910390a15050565b5f8173ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b8152600401611cde9190612705565b602060405180830381865afa158015611cf9573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611d1d9190612dd2565b90505f8111611d2d575050611d4e565b611d4c7f000000000000000000000000000000000000000000000000000000000000000082611ca4565b505b50565b5f805f60405180604001604052808681526020018581525090505f60405180604001604052808681526020018781525090505f8773ffffffffffffffffffffffffffffffffffffffff166338ed17398360405160240160405160208183030381529060405260405160240161096857506040518063ffffffff1660e01b815260040180828152602001915050602060405180830381865afa158015611df9573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611e1d9190612dd2565b90505f611e2c82878785611b90565b9050809450819550505050509392505050565b5f8173ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b8152600401611e799190612705565b602060405180830381865afa158015611e94573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611eb89190612dd2565b90505f8111611efc576040517f08c379a0000000000000000000000000000000000000000000000000000000008152600401611ef390612e47565b60405180910390fd5b611f167f000000000000000000000000000000000000000000000000000000000000000082611ca4565b5050565b5f8173ffffffffffffffffffffffffffffffffffffffff1663ad5c46486040518163ffffffff1660e01b8152600401602060405180830381865afa158015611f64573d5f803e3d5ffd5b505050506040513d601f19601f82011682018060405250810190611f889190613332565b90505f60405180604001604052808381526020018473ffffffffffffffffffffffffffffffffffffffff168152509050806040518060400160405280865f015181526020018660200151815250915050919050565b5f73794a61358d6845594f94dc1db02a252b5b4814ad73ffffffffffffffffffffffffffffffffffffffff1663ab9c4b5d308585855f6040518663ffffffff1660e01b815260040161203b95949392919061335d565b5f604051808303815f87803b158015612052575f80fd5b505af1158015612064573d5f803e3d5ffd5b50505050505050505050565b60405180604001604052805f81526020015f81525090565b606083815f8167ffffffffffffffff8111156120ad576120ac61298c565b5b6040519080825280602002602001820160405280156120db5781602001602082028036833780820191505090505b5090508481815181106120f1576120f061349c565b5b602002602001018181525050838160018151811061211257612111613316565b5b602002602001018181525050809250505092915050565b606083815f8167ffffffffffffffff81111561214857612147612b56565b5b6040519080825280602002602001820160405280156121765781602001602082028036833780820191505090505b5090508481815181106121ac576121ab61349c565b5b602002602001018181525050838160018151811061 21cd576121cc61349c565b5b602002602001018181525050809250505092915050565b5f808573ffffffffffffffffffffffffffffffffffffffff166338ed1739866040518263ffffffff1660e01b81526004016122229190612b22565b602060405180830381865afa15801561223d573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906122619190612dd2565b90505f6127108260200151612710612279919061318d565b612283919061349f565b61228d91906134cf565b90505f8773ffffffffffffffffffffffffffffffffffffffff166338ed1739886040518263ffffffff1660e01b81526004016122c99190612b22565b602060405180830381865afa1580156122e4573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906123089190612dd2565b90505f8973ffffffffffffffffffffffffffffffffffffffff166338ed17398a6040518263ffffffff1660e01b81526004016123449190612b22565b602060405180830381865afa15801561235f573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906123839190612dd2565b90505f612710836020015161271061239b919061318d565b6123a5919061349f565b6123af91906134cf565b9050808210156123ee576040517f08c379a00000000000000000000000000000000000000000000000000000000081526004016123e590613552565b60405180910390fd5b80826123fa919061318d565b945050505050949350505050565b5f73c873fecbd354f5a56e00e710b90ef4201db2448d73ffffffffffffffffffffffffffffffffffffffff163373ffffffffffffffffffffffffffffffffffffffff161461248a576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161248190612da0565b60405180910390fd5b5f8173ffffffffffffffffffffffffffffffffffffffff166370a08231306040518263ffffffff1660e01b81526004016124c49190612705565b602060405180830381865afa1580156124df573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906125039190612dd2565b90505f8111612547576040517f08c379a000000000000000000000000000000000000000000000000000000000815260040161253e90612e47565b60405180910390fd5b61256173c873fecbd354f5a56e00e710b90ef4201db2448d8261178c565b505050565b5f808573ffffffffffffffffffffffffffffffffffffffff166338ed1739866040518263ffffffff1660e01b81526004016125a19190612b22565b602060405180830381865afa1580156125bc573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906125e09190612dd2565b90505f6127108260200151612710612278919061318d565b61260291906134cf565b90505f8773ffffffffffffffffffffffffffffffffffffffff166338ed1739886040518263ffffffff1660e01b815260040161263e9190612b22565b602060405180830381865afa158015612659573d5f803e3d5ffd5b505050506040513d601f19601f8201168201806040525081019061267d9190612dd2565b90505f8973ffffffffffffffffffffffffffffffffffffffff166338ed17398a6040518263ffffffff1660e01b81526004016126b99190612b22565b602060405180830381865afa1580156126d4573d5f803e3d5ffd5b505050506040513d601f19601f820116820180604052508101906126f89190612dd2565b90505f612710836020015161271061239b919061318d565b6127229190613570565b61272c91906134cf565b90505f82828561273c91906130e9565b61274691906130e9565b90508060200151935050505095945050505050565b5f73ffffffffffffffffffffffffffffffffffffffff82169050919050565b5f6127858261275c565b9050919050565b6127958161277b565b82525050565b5f8115159050919050565b6127af8161279b565b82525050565b5f602082840312156127ca576127c96135a3565b5b5f6127d78482850161278c565b91505092915050565b5f819050919050565b6127f2816127e0565b82525050565b5f60208201905061280b5f8301846127e9565b92915050565b612816816127e0565b8114612820575f80fd5b50565b5f8135905061283181612813565b92915050565b5f806040838503121561284d5761284c6135a3565b5b5f61285a8582860161278c565b925050602061286b85828601612823565b9150509250929050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601160045260245ffd5b5f6128ac826127e0565b91506128b7836127e0565b92508282019050808211156128cf576128ce612875565b5b92915050565b5f80fd5b5f601f19601f8301169050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52604160045260245ffd5b61291f826128d9565b810181811067ffffffffffffffff8211171561293e5761293d6128e9565b5b80604052505050565b5f612950612599565b905061295c8282612916565b919050565b5f67ffffffffffffffff82111561297b5761297a6128e9565b5b602082029050602081019050919050565b5f80fd5b5f61299a82612823565b905092915050565b5f6129b66129b184612961565b612947565b905080838252602082019050602084028301858111156129d9576129d861298c565b5b835b81811015612a0257806129ee888261298f565b8452602084019350506020810190506129db565b5050509392505050565b5f82601f830112612a2057612a1f6128d5565b5b8135612a308482602086016129a4565b91505092915050565b5f60c08284031215612a4e57612a4d612590565b5b612a5860c0612947565b90505f612a678482850161278c565b5f830152506020612a7a8482850161278c565b6020830152506040612a8e8482850161278c565b6040830152506060612aa28482850161278c565b6060830152506080612ab684828501612823565b60808301525060a082013567ffffffffffffffff811115612ada57612ad96128d5565b5b612ae684828501612a0c565b60a08301525092915050565b612afb8161279b565b82525050565b5f604082019050612b145f8301856127e9565b612b216020830184612af2565b9392505050565b5f602082019050612b3b5f8301846127e9565b92915050565b5f8060408385031215612b5757612b566135a3565b5b5f612b648582860161278c565b9250506020612b7585828601612823565b9150509250929050565b5f612b898261275c565b9050919050565b612b9981612b7f565b8114612ba3575f80fd5b50565b5f81359050612bb481612b90565b92915050565b5f612bc48261275c565b9050919050565b612bd481612bba565b8114612bde575f80fd5b50565b5f81359050612bef81612bcb565b92915050565b612bfe8161277b565b8114612c08575f80fd5b50565b5f81359050612c1981612bf5565b92915050565b5f805f805f60a08688031215612c3857612c376135a3565b5b5f612c4588828901612ba6565b9550506020612c5688828901612823565b9450506040612c6788828901612be1565b9350506060612c7888828901612c0b565b9250506080612c8988828901612c0b565b9150509295509295909350565b5f60e08284031215612cab57612caa612590565b5b612cb560e0612947565b90505f612cc48482850161278c565b5f830152506020612cd78482850161278c565b6020830152506040612ceb8482850161278c565b6040830152506060612cff8482850161278c565b6060830152506080612d1384828501612823565b60808301525060a0612d2784828501612823565b60a08301525060c0612d3b84828501612c0b565b60c08301525092915050565b5f819050919050565b612d5981612d47565b82525050565b5f604082019050612d725f830185612d50565b612d7f6020830184612af2565b9392505050565b5f82825260208201905092915050565b7f4e6f74206f776e6572000000000000000000000000000000000000000000000005f82015250565b5f612dca600983612d86565b9150612dd582612da0565b602082019050919050565b5f6020820190508181035f830152612df781612dbf565b9050919050565b5f81519050612e0c81612813565b92915050565b5f60208284031215612e2757612e266135a3565b5b5f612e3484828501612dfe565b91505092915050565b7f4e6f2062616c616e63650000000000000000000000000000000000000000000005f82015250565b5f612e71600a83612d86565b9150612e7c82612e41565b602082019050919050565b5f6020820190508181035f830152612e9e81612e69565b9050919050565b612eae8161279b565b8114612eb8575f80fd5b50565b5f81519050612ec981612ea5565b92915050565b5f60208284031215612ee457612ee36135a3565b5b5f612ef184828501612ebb565b91505092915050565b7f5472616e73666572206661696c656400000000000000000000000000000000005f82015250565b5f612f2e600f83612d86565b9150612f3982612efa565b602082019050919050565b5f6020820190508181035f830152612f5b81612f22565b9050919050565b7f4e6f2045544800000000000000000000000000000000000000000000000000005f82015250565b5f612f96600683612d86565b9150612fa182612f62565b602082019050919050565b5f6020820190508181035f830152612fc381612f8a565b9050919050565b5f81905092915050565b50565b5f612fe25f83612fca565b9150612fed82612fd4565b5f82019050919050565b5f61300182612fd7565b9150819050919050565b7f455448207472616e73666572206661696c656400000000000000000000000000005f82015250565b5f61303f601383612d86565b915061304a8261300b565b602082019050919050565b5f6020820190508181035f83015261306c81613034565b9050919050565b5f60408201905061308660208301856127e9565b61309360408301846127e9565b9392505050565b5f819050919050565b5f6130bd6130b86130b38461275c565b61309a565b61275c565b9050919050565b5f6130ce826130a3565b9050919050565b5f6130df826130c4565b9050919050565b6130ef816130d5565b82525050565b5f6040820190506131085f8301856130e6565b61311560208301846127e9565b9392505050565b7f4e6f2070726f66697400000000000000000000000000000000000000000000005f82015250565b5f613150600983612d86565b915061315b8261311c565b602082019050919050565b5f6020820190508181035f83015261317d81613144565b9050919050565b5f61318e826127e0565b9150613199836127e0565b92508282039050818111156131b1576131b0612875565b5b92915050565b7f496e76616c696420616d6f756e7400000000000000000000000000000000000005f82015250565b5f6131eb600e83612d86565b91506131f6826131b7565b602082019050919050565b5f6020820190508181035f830152613218816131df565b9050919050565b7f456d657267656e6379207472616e73666572206661696c65640000000000000005f82015250565b5f613253601983612d86565b915061325e8261321f565b602082019050919050565b5f6020820190508181035f83015261328081613247565b9050919050565b7f496e76616c696420726f757465723100000000000000000000000000000000005f82015250565b5f6132bb600f83612d86565b91506132c682613287565b602082019050919050565b5f6020820190508181035f8301526132e8816132af565b9050919050565b5f81519050613300816128a4565b92915050565b5f6020828403121561331b5761331a6135a3565b5b5f613328848285016132ef565b91505092915050565b5f60c082019050613344828a8a8b8c8d8e6000808e815260200180602001848e88888888888888888888888888888f0150509b9a5050505050505050505050505050565b5f8151905061339f81612bf5565b92915050565b5f602082840312156133ba576133b96135a3565b5b5f6133c784828501613391565b91505092915050565b7f4f6e6c7920416176650000000000000000000000000000000000000000000000005f82015250565b5f613404600983612d86565b915061340f826133d0565b602082019050919050565b5f6020820190508181035f830152613431816133f8565b9050919050565b7f496e76616c696420696e69746961746f7200000000000000000000000000000005f82015250565b5f61346c601183612d86565b915061347782613438565b602082019050919050565b5f6020820190508181035f83015261349981613460565b9050919050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52603260045260245ffd5b5f6134d8826127e0565b91506134e3836127e0565b92508282026134f1816127e0565b9150828204841483151761350857613507612875565b5b5092915050565b7f4e487b71000000000000000000000000000000000000000000000000000000005f52601260045260245ffd5b5f613547826127e0565b9150613552836127e0565b9250826135625761356161350f565b5b828204905092915050565b7f50726f66697420626" elŸà6f77206d696e696d756d00000000000000000000000005f82015250565b5f6135a2601483612d86565b91506135ad8261356e565b602082019050919050565b5f6020820190508181035f8301526135cf81613596565b9050919050565b5f80fd5b5f80fdfea2646970667358221220"; 
        
        const CONTRACT_ABI = [{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"dex1","type":"address"},{"indexed":true,"internalType":"address","name":"dex2","type":"address"},{"indexed":false,"internalType":"uint256","name":"profitNet","type":"uint256"}],"name":"ArbitrageSuccess","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"ETHWithdrawn","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"token","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":false,"internalType":"uint256","name":"profit","type":"uint256"}],"name":"FlashloanExecuted","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"internalType":"address","name":"token","type":"address"},{"indexed":false,"internalType":"uint256","name":"amount","type":"uint256"},{"indexed":true,"internalType":"address","name":"to","type":"address"}],"name":"ProfitWithdrawn","type":"event"},{"inputs":[],"name":"AAVE_POOL","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"CAMELOT","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"SUSHISWAP","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"}],"name":"emergencyWithdraw","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"components":[{"internalType":"address","name":"router1","type":"address"},{"internalType":"address","name":"router2","type":"address"},{"internalType":"address","name":"tokenIn","type":"address"},{"internalType":"address","name":"tokenOut","type":"address"},{"internalType":"uint256","name":"minProfit","type":"uint256"},{"internalType":"uint256","name":"slippageBps","type":"uint256"}],"internalType":"struct FlashloanArbitrageV4.ArbitrageData","name":"arbData","type":"tuple"}],"name":"executeFlashloan","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"asset","type":"address"},{"internalType":"uint256","name":"amount","type":"uint256"},{"internalType":"uint256","name":"premium","type":"uint256"},{"internalType":"address","name":"initiator","type":"address"},{"internalType":"bytes","name":"params","type":"bytes"}],"name":"executeOperation","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"}],"name":"getBalance","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"owner","outputs":[{"internalType":"address","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"router1","type":"address"},{"internalType":"address","name":"router2","type":"address"},{"internalType":"address","name":"tokenIn","type":"address"},{"internalType":"address","name":"tokenOut","type":"address"},{"internalType":"uint256","name":"amountIn","type":"uint256"}],"name":"simulateArbitrage","outputs":[{"internalType":"uint256","name":"estimatedProfit","type":"uint256"},{"internalType":"bool","name":"isProfitable","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"token","type":"address"}],"name":"withdraw","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"withdrawETH","outputs":[],"stateMutability":"nonpayable","type":"function"},{"stateMutability":"payable","type":"receive"}];

        let provider;
        let signer;
        let userAccount;

        // Mostrar c√≥digo
        document.getElementById('showCodeBtn').addEventListener('click', function() {
            const codeDiv = document.getElementById('contractCode');
            const codeContent = document.getElementById('codeContent');
            
            if (codeDiv.style.display === 'none') {
                codeContent.textContent = SOLIDITY_CODE;
                codeDiv.style.display = 'block';
                this.textContent = '‚ùå Ocultar C√≥digo';
            } else {
                codeDiv.style.display = 'none';
                this.textContent = 'üìã Ver C√≥digo Completo do Contrato';
            }
        });

        // Conectar wallet
        document.getElementById('connectBtn').addEventListener('click', async function() {
            try {
                if (!window.ethereum) {
                    alert('Por favor, instale MetaMask ou OKX Wallet!');
                    return;
                }

                const statusDiv = document.getElementById('walletStatus');
                statusDiv.className = 'status info';
                statusDiv.textContent = 'Conectando...';

                provider = new ethers.providers.Web3Provider(window.ethereum);
                await provider.send("eth_requestAccounts", []);
                signer = provider.getSigner();
                userAccount = await signer.getAddress();

                const network = await provider.getNetwork();
                
                document.getElementById('networkName').textContent = network.name;
                document.getElementById('chainId').textContent = network.chainId;
                document.getElementById('userAddress').textContent = userAccount.substring(0,6) + '...' + userAccount.substring(38);
                document.getElementById('networkInfo').style.display = 'flex';

                if (network.chainId !== 42161) {
                    statusDiv.className = 'status error';
                    statusDiv.innerHTML = `
                        <strong>‚ö†Ô∏è Rede Incorreta!</strong><br>
                        Voc√™ est√° na rede: ${network.name} (Chain ID: ${network.chainId})<br>
                        Por favor, mude para <strong>Arbitrum One (Chain ID: 42161)</strong>
                    `;
                    document.getElementById('deployBtn').disabled = true;
                    return;
                }

                statusDiv.className = 'status success';
                statusDiv.innerHTML = `
                    <strong>‚úÖ Conectado com sucesso!</strong><br>
                    Rede: ${network.name} | Endere√ßo: ${userAccount.substring(0,10)}...
                `;

                document.getElementById('deployBtn').disabled = false;
                this.textContent = '‚úÖ Wallet Conectada';
                this.disabled = true;

            } catch (error) {
                const statusDiv = document.getElementById('walletStatus');
                statusDiv.className = 'status error';
                statusDiv.textContent = 'Erro ao conectar: ' + error.message;
            }
        });

        // Deploy contrato
        document.getElementById('deployBtn').addEventListener('click', async function() {
            try {
                const progressDiv = document.getElementById('deployProgress');
                const statusDiv = document.getElementById('deployStatus');
                const resultDiv = document.getElementById('deployResult');
                const progressFill = document.getElementById('progressFill');

                progressDiv.style.display = 'block';
                resultDiv.style.display = 'none';
                this.disabled = true;

                // Progresso: 20%
                progressFill.style.width = '20%';
                statusDiv.className = 'status info';
                statusDiv.innerHTML = '<div class="loading"></div> Preparando deploy...';

                // Criar factory
                const factory = new ethers.ContractFactory(CONTRACT_ABI, CONTRACT_BYTECODE, signer);

                // Progresso: 40%
                progressFill.style.width = '40%';
                statusDiv.innerHTML = '<div class="loading"></div> Enviando transa√ß√£o de deploy...';

                // Deploy
                const contract = await factory.deploy();

                // Progresso: 60%
                progressFill.style.width = '60%';
                statusDiv.innerHTML = `
                    <div class="loading"></div> Aguardando confirma√ß√£o na blockchain...<br>
                    <small>TX Hash: ${contract.deployTransaction.hash}</small>
                `;

                // Aguardar confirma√ß√£o
                await contract.deployed();

                // Progresso: 100%
                progressFill.style.width = '100%';
                statusDiv.className = 'status success';
                statusDiv.innerHTML = '‚úÖ Contrato deployado com sucesso!';

                // Mostrar resultado
                resultDiv.style.display = 'block';
                resultDiv.className = 'success-box';
                resultDiv.innerHTML = `
                    <h3 style="margin-bottom: 15px;">üéâ Deploy Completo!</h3>
                    <div style="background: white; padding: 15px; border-radius: 8px; margin: 15px 0;">
                        <strong>Endere√ßo do Contrato V4:</strong><br>
                        <code style="font-size: 16px; color: #667eea; display: block; margin-top: 8px; word-break: break-all;">
                            ${contract.address}
                        </code>
                    </div>
                    <button class="btn" onclick="navigator.clipboard.writeText('${contract.address}')">
                        üìã Copiar Endere√ßo
                    </button>
                    <div style="margin-top: 20px; padding: 15px; background: #e3f2fd; border-radius: 8px;">
                        <strong>üéØ Pr√≥ximos Passos:</strong>
                        <ol style="margin: 10px 0 0 20px; line-height: 2;">
                            <li>Copie o endere√ßo acima</li>
                            <li>Abra <strong>FlashloanArbitrage_Enhanced.html</strong></li>
                            <li>Cole o endere√ßo do contrato</li>
                            <li>Configure valores maiores (preset "M√©dio" ou "Alto")</li>
                            <li>Aguarde oportunidades</li>
                            <li><strong>Os lucros ir√£o AUTOMATICAMENTE para sua wallet! üí∞</strong></li>
                        </ol>
                    </div>
                    <div style="margin-top: 15px; padding: 12px; background: #d4edda; border-radius: 8px;">
                        <strong>‚úÖ DIFEREN√áA:</strong> Contrato V4 envia lucros <strong>AUTOMATICAMENTE</strong> ap√≥s flashloan<br>
                        Voc√™ N√ÉO precisa chamar withdraw() manualmente! üöÄ
                    </div>
                `;

                console.log('Contrato V4 deployado em:', contract.address);

            } catch (error) {
                const statusDiv = document.getElementById('deployStatus');
                const resultDiv = document.getElementById('deployResult');
                
                statusDiv.className = 'status error';
                statusDiv.textContent = '‚ùå Erro no deploy';

                resultDiv.style.display = 'block';
                resultDiv.className = 'warning-box';
                resultDiv.innerHTML = `
                    <strong>‚ùå Erro no Deploy:</strong><br>
                    ${error.message}<br><br>
                    <strong>Poss√≠veis causas:</strong>
                    <ul style="margin: 10px 0 0 20px;">
                        <li>Saldo insuficiente de ETH para gas</li>
                        <li>Transa√ß√£o rejeitada na wallet</li>
                        <li>Rede incorreta (precisa ser Arbitrum One)</li>
                    </ul>
                `;

                document.getElementById('deployBtn').disabled = false;
                console.error('Erro no deploy:', error);
            }
        });
    </script>
</body>
</html>